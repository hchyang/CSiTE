# PhyloVars

PhyloVars is a python program for simulating somatic mutations in a population of tumor cells. By being fed with a phylogenetic tree in newick format, it can simulate both SNVs and CNVs on it, and reports the coordinates and frequency of each variant.

## Installing

PhyloVars is written in Python3, and numpy is the only pakage which is not included in the standard library of python3.

PhyloVars can be downloaded:

    git clone git@github.com:hchyang/phyloVars.git

## Running PhyloVars

PhyloVar is easy to run. The input tree file should be in newick format, which can be generated by ms program. ms is a very powerful tool used in population genetics. Different pupulation history can be specified by its abandent parameters. Leveraging the power of ms, PhyloVars can provide two main somatic variants (SNVs and CNVs) generated under different tumor growth history.

### Input files

#### Tree file

Tree file should be in newick format:

    ((2:0.083,4:0.083):0.345,(5:0.322,(1:0.030,3:0.030):0.292):0.105);

#### Trunk variants file

You can simulate trunk variants by specify `--trunk_length`, or import trunk variants directly (`--trunk_vars`).
The file format of trunk variants is like:
    
    #chr start end copy
    0 1 1 0
    1 12 123 +3
    0 12 123 -1

- **chr**:    which copy of chrs the var locates in (0 based)
- **start**:  the start of the var
- **end**:    the end of the var
- **copy**:   an interger. 0: SNV, -1: deletion, +int: amplification

P.S. start and end are 0 based. And the region of each var is like in bed: [start,end).


#### All options:

    usage: simulate_somatic_vars.py [-h] -t TREE [-r SNV_RATE] [-R CNV_RATE]
                                    [-d DEL_PROB] [-l CNV_LENGTH_LAMBDA]
                                    [-L CNV_LENGTH_MAX] [-c COPY_MAX] [-p PLOID]
                                    [-x PRUNE] [-X PRUNE_PROPORTION] [-D DEPTH]
                                    [-s RANDOM_SEED] [-V CNV] [-S SNV]
                                    [-P DEPTH_PROFILE] [-n NODES_SNVS] [-g LOG]
                                    [--loglevel {10,20,30,40,50}]
                                    [--trunk_vars TRUNK_VARS]
                                    [--trunk_length TRUNK_LENGTH]
                                    [--tree_data TREE_DATA] [--expands EXPANDS]
                                    [--length LENGTH]
    
    Simulate SNVs/CNVs on a coalescent tree in newick format
    
    optional arguments:
      -h, --help            show this help message and exit
      -t TREE, --tree TREE  a tree in newick format
      -r SNV_RATE, --snv_rate SNV_RATE
                            the muation rate of SNVs [300]
      -R CNV_RATE, --cnv_rate CNV_RATE
                            the muation rate of CNVs [3]
      -d DEL_PROB, --del_prob DEL_PROB
                            the probability of being deletion for a CNV mutation
                            [0.5]
      -l CNV_LENGTH_LAMBDA, --cnv_length_lambda CNV_LENGTH_LAMBDA
                            the lambda of CNVs length [4000000]
      -L CNV_LENGTH_MAX, --cnv_length_max CNV_LENGTH_MAX
                            the maximium of CNVs length [20000000]
      -c COPY_MAX, --copy_max COPY_MAX
                            the maximium ADDITIONAL copy of a CNVs [5]
      -p PLOID, --ploid PLOID
                            the ploid to simulate [2]
      -x PRUNE, --prune PRUNE
                            trim all their children for the branches with equal or
                            less than this number of tips [0]
      -X PRUNE_PROPORTION, --prune_proportion PRUNE_PROPORTION
                            trim all their children for the branches with equal or
                            less than this proportion of tips [0.0]
      -D DEPTH, --depth DEPTH
                            the mean depth for simulating coverage data [50]
      -s RANDOM_SEED, --random_seed RANDOM_SEED
                            the seed for random number generator [None]
      -V CNV, --cnv CNV     the output file to save CNVs [raw.cnvs]
      -S SNV, --snv SNV     the output file to save SNVs [raw.snvs]
      -P DEPTH_PROFILE, --depth_profile DEPTH_PROFILE
                            the file to save depth profile [depth.profile]
      -n NODES_SNVS, --nodes_snvs NODES_SNVS
                            the file to save SNVs on each nodes [nodes.snvs]
      -g LOG, --log LOG     the log file [log.txt]
      --loglevel {10,20,30,40,50}
                            the logging level [10]
      --trunk_vars TRUNK_VARS
                            the trunk variants file
      --trunk_length TRUNK_LENGTH
                            the trunk length [0]
      --tree_data TREE_DATA
                            the file to dump the tree data [tree.dat]
      --expands EXPANDS     the basename of the file to output the snv and segment
                            data for EXPANDS [None]
      --length LENGTH       the length of the sequence to simulate [100000000]


## Authors

* **Hechuan Yang** - [HechuanYang](https://github.com/hchyang)

## License

This project is licensed under the GPL-3.0 License - see the [LICENSE](LICENSE) file for details.
